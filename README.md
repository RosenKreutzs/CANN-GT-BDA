# CA-Transformer RUL预测项目

## 项目简介

本项目旨在使用结合注意力机制和Transformer结构的混合模型（CA-Transformer）对轴承的剩余使用寿命（RUL）进行预测。通过域自适应方法（DAN），模型能够在源域和目标域之间进行知识迁移，提高预测的准确性和泛化能力。项目中使用了PRONOSTIA和XJTU-SY两个实验数据集，并结合了CBAM注意力机制和门控单元来增强特征提取能力。

## 目录

- [项目简介](##项目简介)
- [安装与运行](##安装与运行)
- [数据集说明](#数据集说明)
- [模型架构](#模型架构)
- [结果展示](#结果展示)
- [贡献者](#贡献者)

## 安装与运行

### 环境依赖

确保已安装以下依赖库：

- Python 3.7+
- NumPy
- Pandas
- PyTorch
- matplotlib
- torchstat
- scipy

你可以使用以下命令安装必要的Python库：

```bash
pip install -r requirements.txt
```
[requirements.txt的下载链接](https://github.com/user-attachments/files/18249182/requirements.txt)

## 数据集说明
项目所用开源数据集，可参考XJTU-SY-experiment与PHM-2012-PRONOSTIA
## 模型架构


![图7-RUL预测444](https://github.com/user-attachments/assets/041894f5-ae3e-4d50-a6f7-fdbb0d59bd56)
第一步：信号采集： 分别采集大量来自源域和目标域轴承的历史振动信号。
步骤 2：早期故障检测： 基于 3 峰度特征的算法利用振动信号来检测源域和目标域轴承整个退化过程中的首次预测时间（FPT）。然后利用 FPT 将轴承的整个生命周期分为健康阶段和退化阶段。
步骤 3：振动信号对齐： 使用振动信号对齐流程对来自两个域的振动信号进行校准和对齐。
步骤 4：振动信号特征提取和数据预处理： 从对齐的源域和目标域振动信号中提取一维时间退化特征和二维 TFR，然后分别进行相应的数据预处理。
第五步：数据集划分： 训练集包括来自源域的标记异构退化特征集和来自目标域的非标记异构退化特征集。测试集包括目标域中与测试轴承相关的不同降解特征集。在此过程中，退化值被用作模型预测 RUL 的标签。值得注意的是，每个轴承的 RUL 标签都经过调整，以符合 [0,1] 的归一化范围。
步骤 6：模型训练： 使用提供的训练集训练 CANN-GT-BDA 模型。在前向传播过程中，计算源域内训练样本的 RUL 值和深度退化融合特征，同时从目标域内的训练样本中提取深度退化融合特征。然后，利用反向传播使源域内 RUL 的预测误差最小化，并优化源域和目标域之间深度退化融合特征的分布差异。优化目标包括两个要素： (1) 预测误差；(2) 高级融合特征在两个域之间的分布差异。
步骤 7：模型测试： 训练有素的模型通过分析不同降解特征来评估目标域内测试轴承的 RUL。为了在测试过程中增强模型的泛化能力，应用 MC Dropout 将其扩展为近似贝叶斯双通道神经网络。这种方法可以推导出测试轴承 RUL 的置信区间 (Cis)，从而有效量化预测结果的不确定性。

## 结果展示
[结果展示的链接](https://github.com/RosenKreutzs/CANN-GT-BDA/blob/main/test-Bearing1_3-CA-Transformer-with%20MC%20Dropout-CIs.ipynb)

## 贡献者
Yuhang Song
